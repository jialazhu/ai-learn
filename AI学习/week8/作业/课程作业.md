本次作业将结合课程的两个核心模块：**序列标注**和**文本匹配**，要求同学们完成一个完整的智能问答系统。该系统需要从用户问题中识别关键实体，然后在知识库中找到最相关的答案。
## 作业背景
假设你正在为一家电商公司开发智能客服系统，需要处理用户关于产品、订单、物流等问题的咨询。系统需要：
1. 识别用户问题中的关键实体（产品名、订单号、时间等）
2. 在FAQ知识库中找到最相关的问题和答案
3. 返回最匹配的答案给用户

## 作业要求

### 基础要求

#### 1. 数据准备

**任务**：构建训练数据集和测试数据集

**具体要求**：
- 创建用户问题样本，包含以下实体类型：
  - `PRODUCT`：产品名称（如"iPhone 15"、"小米手机"）
  - `ORDER`：订单号（如"ORD123456"）
  - `TIME`：时间表达（如"昨天"、"2024年1月"）
  - `LOCATION`：地点（如"北京"、"上海"）
  - `PRICE`：价格（如"1000元"、"￥500"）

- 创建对应的FAQ知识库，包含至少20个问答对（可用大模型生成）
- 数据格式要求：
  ```json
  {
    "questions": [
      {
        "id": 1,
        "text": "我的iPhone 15订单ORD123456什么时候能到北京？",
        "entities": [
          {"text": "iPhone 15", "label": "PRODUCT", "start": 2, "end": 11},
          {"text": "ORD123456", "label": "ORDER", "start": 13, "end": 22},
          {"text": "北京", "label": "LOCATION", "start": 28, "end": 30}
        ]
      }
    ],
    "faq": [
      {
        "id": 1,
        "question": "订单什么时候能到？",
        "answer": "订单一般3-5个工作日送达，具体时间请查看物流信息。"
      }
    ]
  }
  ```
#### 2. 序列标注模型实现

**任务**：实现命名实体识别模型

**具体要求**：
- 实现BiLSTM+CRF模型（参考课程代码）
- 实现BERT微调模型（参考课程代码）
- 对比两种模型的性能
- 代码要求：
  ```python
  class NERModel:
      def __init__(self, model_type='bilstm_crf'):
          # 初始化模型
          pass
      
      def train(self, train_data, val_data):
          # 训练模型
          pass
      
      def predict(self, text):
          # 预测实体
          return entities
      
      def evaluate(self, test_data):
          # 评估模型性能
          return metrics
  ```

#### 3. 文本匹配模型实现

**任务**：实现文本相似度计算模型

**具体要求**：
- 实现Sentence-BERT模型进行文本匹配
- 实现简单的向量检索系统
- 支持实时查询和批量处理
- 代码要求：
  ```python
  class TextMatcher:
      def __init__(self, model_name='sentence-transformers/all-MiniLM-L6-v2'):
          # 初始化模型
          pass
      
      def encode_texts(self, texts):
          # 编码文本为向量
          return vectors
      
      def find_similar(self, query, candidates, top_k=5):
          # 找到最相似的文本
          return results
      
      def batch_search(self, queries, candidates):
          # 批量搜索
          return results
  ```

#### 4. 系统集成

**任务**：将NER和文本匹配模块集成

**具体要求**：
- 实现完整的问答系统
- 支持端到端的查询处理
- 提供简单的Web界面或命令行界面
- 代码要求：
  ```python
  class IntelligentQASystem:
      def __init__(self):
          self.ner_model = NERModel()
          self.text_matcher = TextMatcher()
          self.faq_database = self.load_faq()
      
      def process_query(self, user_question):
          # 1. 识别实体
          entities = self.ner_model.predict(user_question)
          
          # 2. 检索相关FAQ
          similar_questions = self.text_matcher.find_similar(
              user_question, self.faq_database['questions']
          )
          
          # 3. 返回最佳答案
          return self.generate_answer(entities, similar_questions)
      
      def generate_answer(self, entities, similar_questions):
          # 基于实体和相似问题生成答案
          pass
  ```


### 进阶要求（可选）

#### 5. 模型优化

**任务**：优化模型性能和效果

**具体要求**：
- 实现数据增强策略（同义词替换、实体替换等）
- 实现模型压缩技术（知识蒸馏、量化等）
- 对比优化前后的性能差异
- 代码要求：
  ```python
  class ModelOptimizer:
      def __init__(self):
          pass
      
      def data_augmentation(self, data):
          # 数据增强
          return augmented_data
      
      def model_compression(self, model):
          # 模型压缩
          return compressed_model
      
      def performance_analysis(self, original_model, optimized_model):
          # 性能分析
          return analysis_report
  ```



#### 6. 高级功能（可选）

**任务**：实现高级功能增强系统能力

**具体要求**：
- 实现多轮对话支持
- 实现意图识别功能
- 实现答案生成和个性化
- 代码要求：
  ```python
  class AdvancedQASystem(IntelligentQASystem):
      def __init__(self):
          super().__init__()
          self.conversation_memory = ConversationMemory()
          self.intent_classifier = IntentClassifier()
      
      def multi_turn_conversation(self, user_input, conversation_history):
          # 多轮对话处理
          pass
      
      def intent_classification(self, user_input):
          # 意图识别
          return intent
      
      def personalized_answer(self, answer, user_profile):
          # 个性化答案生成
          return personalized_answer
  ```